<!DOCTYPE html>
<html>
<head>
  <title>Invoice</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
    }

    input {
      width: 100%;
      box-sizing: border-box;
      padding: 5px;
    }

    button {
      padding: 8px 14px;
      margin-top: 10px;
      cursor: pointer;
    }

    /* ================= INVOICE DESIGN ================= */

    .invoice {
      display: none;
      margin-top: 30px;
	     border: none !important;
	  outline: none !important;
    }

    .invoice-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
	  border: none !important;
	  outline: none !important;
    }
    .invoice-header img {
	  width: 100%;
	  max-height: 120px;
	  object-fit: contain;
	   border: none !important;
	  outline: none !important;
	}
    

    .invoice-meta {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .invoice-meta .left {
      width: 60%;
    }

    .invoice-meta .right {
      width: 40%;
      text-align: right;
    }

    .invoice-meta h4,
    .invoice-meta h6 {
      margin: 4px 0;
    }

    .invoice-table th {
      background: #d1e7dd;
    }

    .no-print {
      margin-top: 15px;
      text-align: right;
    }

    /* ================= PRINT FIX ================= */
    @media print {
      #formArea,
      button {
        display: none !important;
      }

      .invoice {
        display: block !important;
		 border: none !important;
	  outline: none !important;
      }

      body {
        padding: 0;
      }
    }
  </style>
</head>

<body>

<!-- ================= FORM AREA ================= -->
<div id="formArea">

  <h2>Create Invoice</h2>

  <label>Date:</label>
  <input type="date" id="date"><br><br>

  <label>Invoice No:</label>
  <input type="text" id="invno" readonly><br><br>

  <label>Invoice To:</label>
  <input type="text" id="to"><br><br>

  <table id="inputTable">
    <tr>
      <th>Description</th>
      <th>Qty</th>
      <th>Rate Per</th>
      <th>Amount</th>
    </tr>
  </table>

  <button onclick="addRow()">+ Add Row</button>
  <br><br>
  <button onclick="preview()">Preview Invoice</button>

</div>

<!-- ================= INVOICE PREVIEW ================= -->
<div class="invoice" id="invoice">

  <!-- HEADER -->
  <div class="invoice-header">
   
    <img src="logoheaders.png" alt="Company Logo"><br>
   
	
  </div>

  <!-- BILL TO & META -->
  <div class="invoice-meta">
  
  <div class="left">
      <div>
        <strong>Invoice #</strong><br>
        <span id="pinv"></span>
      </div>
      <div style="margin-top:6px;">
        <strong>Invoice Date</strong><br>
        <span id="pdate"></span>
      </div>
	  
    </div>
	 <div class="right">
      <h4>Bill To</h4>
      <h6 id="pto"></h6>
    </div>

    
  </div>
   

  <!-- ITEMS TABLE -->
  <table id="previewTable" class="invoice-table">
    <tr>
      <th>Description</th>
      <th>Quantity</th>
      <th style="text-align:right;">Rate Per</th>
      <th style="text-align:right;">Amount</th>
    </tr>
  </table>

  <!-- TOTAL -->
  <h3 style="text-align:right; margin-top:15px;">
    Total: â‚¹ <span id="total">0</span>
  </h3>

  <!-- PRINT -->
  <div class="no-print">
    <button onclick="window.print()">Print / Save as PDF</button>
  </div>

</div>

<script>
/* ================= AUTO INVOICE NUMBER ================= */
let count = localStorage.getItem("INV_NO") || 0;
count++;
localStorage.setItem("INV_NO", count);
document.getElementById("invno").value =
  "INV-" + String(count).padStart(4, "0");
/* ================= ADD FIRST ROW ================= */
addRow();

/* ================= ADD ROW ================= */
function addRow() {
  let table = document.getElementById("inputTable");
  let row = table.insertRow();
  row.innerHTML = `
    <td><input></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input readonly></td>
  `;
}

/* ================= CALCULATE ================= */
function calc(el) {
  let row = el.parentElement.parentElement;
  let qty = row.cells[1].children[0].value || 0;
  let rate = row.cells[2].children[0].value || 0;
  row.cells[3].children[0].value = qty * rate;
}

/* ================= PREVIEW ================= */
function preview() {
  document.getElementById("invoice").style.display = "block";

  document.getElementById("pdate").innerText = date.value;
  document.getElementById("pinv").innerText = invno.value;
  document.getElementById("pto").innerText = to.value;

  let previewTable = document.getElementById("previewTable");
  previewTable.innerHTML = `
    <tr>
      <th>Description</th>
      <th>Quantity</th>
      <th style="text-align:right;">Rate Per</th>
      <th style="text-align:right;">Amount</th>
    </tr>
  `;

  let total = 0;

  document.querySelectorAll("#inputTable tr").forEach((row, i) => {
    if (i > 0) {
      let desc = row.cells[0].children[0].value;
      let qty = row.cells[1].children[0].value;
      let rate = row.cells[2].children[0].value;
      let amt = row.cells[3].children[0].value;

      if (desc !== "") {
        let r = previewTable.insertRow();
        r.innerHTML = `
          <td>${desc}</td>
          <td>${qty}</td>
          <td style="text-align:right;">${rate}</td>
          <td style="text-align:right;">${amt}</td>
        `;
        total += Number(amt || 0);
      }
    }
  });

  document.getElementById("total").innerText = total;
}
</script>

</body>
</html>
